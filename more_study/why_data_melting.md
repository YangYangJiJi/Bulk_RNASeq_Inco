# data를 melting하는 이유와 wide/long 형식
= plot을 그리기 위해! <br>
= plot을 그리는 함수인 ggplot2가 이해하기에 쉬운 형태로 만들어주기 위해

## 설명
1. **reshape2 패키지**의 `melt` 함수는 **wide 형식**의 데이터를 **long 형식**으로 변환하여 ggplot2와 같은 시각화 도구에서 더 쉽게 처리할 수 있도록 만듭니다.
2. **`merge`** 함수를 사용하여 **메타데이터**와 샘플 데이터를 결합합니다.
3. **정규화된 데이터**와 **정규화되지 않은 데이터**를 모두 변환하고 결합하여 시각화 준비를 합니다.
4. 작업을 저장하여 **다음에 쉽게 불러올 수** 있도록 합니다.

이 코드는 데이터를 **long 형식**으로 변환하고 **메타데이터와 결합**한 후, 이후 시각화 및 분석을 위한 준비 과정입니다.

## wide 형식과 long 형식 차이
### Wide 형식
- Wide 형식에서는 각 샘플(혹은 관찰치)이 여러 개의 열에 분리되어 저장됩니다. 예를 들어, 아래와 같이 각 유전자별 발현 값이 각 샘플에 대해 별도의 열로 나뉘어 있을 수 있습니다:

| gene   | Sample_1 | Sample_2 | Sample_3 |
| ------ | -------- | -------- | -------- |
| Gene_A | 100      | 120      | 110      |
| Gene_B | 200      | 180      | 220      |
| Gene_C | 50       | 60       | 55       |

- **Wide 형식**에서는 각 샘플(Sample_1, Sample_2, Sample_3)이 각각 별도의 열로 나누어져 있고, 유전자별로 행이 나누어져 있습니다.


### Long 형식
- Long 형식으로 변환하면 각 샘플에 대한 정보가 **행으로 나열**되고, **각각의 샘플이 하나의 행**에 포함되도록 데이터 구조가 바뀝니다. 예시로 위의 wide 형식을 long 형식으로 변환하면 아래와 같습니다:

| gene   |   sample | count |
| ------ | -------- | ----- |
| Gene_A | Sample_1 | 100 |
| Gene_A | Sample_2 | 120 |
| Gene_A | Sample_3 | 110 |
| Gene_B | Sample_1 | 200 |
| Gene_B | Sample_2 | 180 |
| Gene_B | Sample_3 | 220 |
| Gene_C | Sample_1 | 50 |
| Gene_C | Sample_2 | 60 |
| Gene_C | Sample_3 | 55 |

- **Long 형식**에서는 `sample` 열이 각 샘플을 나타내고, 각 샘플에 대한 발현 값(`count`)이 하나의 열에 모여 있습니다. 각 샘플의 데이터가 **행으로 나열**되어 있어, **ggplot2**와 같은 시각화 도구에서 데이터가 처리하기 쉽고, 다양한 분석을 할 때 유용합니다.

### Wide 형식과 Long 형식의 차이점

- **Wide 형식**은 각 샘플에 대한 데이터를 **열로 나누어 저장**합니다. 주로 각 샘플 간의 비교가 어려운 구조입니다.
- **Long 형식**은 여러 샘플에 대한 데이터를 **행으로 나열**하여, 동일한 변수에 대한 여러 값을 **하나의 열에 모은 구조**입니다. 이 형식은 **시각화와 분석에 더 유리**합니다.

### 왜 long 형식으로 변환할까요?

1. **시각화**: `ggplot2`와 같은 시각화 도구는 long 형식에서 데이터를 **손쉽게 해석**하고, 다양한 그래프를 그릴 수 있습니다. 예를 들어, 여러 샘플을 x축에 놓고 유전자 발현 값을 y축으로 두어 그룹별로 차이를 볼 수 있습니다.
2. **데이터 분석**: 여러 샘플을 분석할 때 **long 형식**이 더 유리합니다. 예를 들어, `ggplot2`로 **box plot, violin plot** 등을 그리거나, **통계 분석**을 할 때 데이터가 일관되게 배열되어 있어 처리하기 쉽습니다.
3. **추후 변환 작업**: long 형식은 데이터를 **다양한 방식**으로 변환하거나, 분석하기에 더 유연합니다.

### 요약

- **Wide 형식**: 각 샘플이 별도의 열로 나누어져 있어서 한 유전자의 데이터를 여러 샘플에 대해 비교하기 어렵습니다.
- **Long 형식**: 각 샘플의 데이터를 **하나의 열로 묶어** 놓아, 분석과 시각화가 훨씬 편리하고 직관적입니다.